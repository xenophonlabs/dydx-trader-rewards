# dydx-trader-rewards
Reward Optimization Code for dYdX

This repository contains all the code used for our review of the dYdX tradinig rewards mechanism. All plots are generated by running the `analysis.py` file, and are saved in the `images` directory. All notebooks provide examples of how to use `utils.py`. Historical data is gathered in `historical_data.ipynb`. Below is a description of how to use the code provided in `utils.py`.

Most functions in `utils.py` have two versions, one which acounts to stakedDYDX and one that does not. 

### Newton's Method

To simulate a trading rewards epoch use the `find_equilibrium(...)` function with appropriate parameters. This function uses Newton's method to update a fees vector <b>F</b> until it converges to a Nash equilibrium. A brief description of parameters follows:

<ul>
    <li>`D` is the total average open interest at the end of the epoch.</li>
    <li>`n` is the total number of traders eligible for rewards.</li>
    <li>`R` is the total rewards to be disbursed at the end of the epoch.</li>
    <li>`p` is the price of DYDX token at the end of the epoch.</li>
    <li>`alpha` is the learning rate which must be sufficiently small to ensure convergence.</li>
    <li>`num_whales` is the number of market whales to generate.</li>
    <li>`whale_alpha` is the weight for each whale in the Dirichlet probability density function.</li>
</ul>

To simulate the Nash equilibrium fee vector for epoch 3, for example, we would run:

```
find_equilibrium(200980039.716, R=3835616, n=8502, p=18.849, alpha=0.01, num_whales=10, whale_alpha=100)
```
